@startuml InternshipManagementSystem

' Styling
skinparam classAttributeIconSize 0
skinparam class {
    BackgroundColor<<Entity>> LightYellow
    BackgroundColor<<Controller>> LightBlue
    BackgroundColor<<Boundary>> LightGreen
    BackgroundColor<<Action>> LightPink
    BackgroundColor<<Enum>> LightGray
    BorderColor Black
    ArrowColor Black
}

' ============================================
' ENTITY/MODEL CLASSES
' ============================================
package "Entity Layer" {

    abstract class User <<Entity>> {
        - userID: String
        - name: String
        - email: String
        - password: String
        - userType: UserType
        - loginState: boolean
        --
        + User(String, String, String, String)
        + login(): void
        + logout(): void
        + changePassword(): boolean
        + getUserID(): String
        + getName(): String
        + getEmail(): String
        + getPassword(): String
        + getUserType(): UserType
        + isLoggedIn(): boolean
        + setUserID(String): void
        + setName(String): void
        + setEmail(String): void
        + setPassword(String): void
        + setUserType(UserType): void
        + toString(): String
    }

    class Student <<Entity>> {
        - major: StudentMajor
        - yearOfStudy: int
        - employedStatus: boolean
        - appliedInternships: ArrayList<InternshipApplication>
        --
        + Student(String, String, String, String, StudentMajor, int)
        + addInternshipApplications(InternshipApplication): void
        + clearInternshipApplications(): void
        + getInternshipApplications(): ArrayList<InternshipApplication>
        + getMajor(): StudentMajor
        + getYearOfStudy(): int
        + isEmployed(): boolean
        + setMajor(StudentMajor): void
        + setYearOfStudy(int): void
        + setEmployedStatus(boolean): void
    }

    class CareerCenterStaff <<Entity>> {
        - role: String
        - department: String
        --
        + CareerCenterStaff(String, String, String, String, String, String)
        + getRole(): String
        + getDepartment(): String
        + setRole(String): void
        + setDepartment(String): void
    }

    class CompanyRep <<Entity>> {
        - companyName: String
        - department: String
        - position: String
        - accountStatus: UserAccountStatus
        - createdInternships: ArrayList<Internship>
        --
        + CompanyRep(String, String, String, String, String, String, String, UserAccountStatus, ArrayList<Internship>)
        + addInternship(Internship): boolean
        + isMaxInternshipReached(): boolean
        + updateInternship(Internship): boolean
        + removeInternship(Internship): boolean
        + viewInternshipApproval(): void
        + getCompanyName(): String
        + getDepartment(): String
        + getPosition(): String
        + getAccountStatus(): UserAccountStatus
        + getCreatedInternships(): ArrayList<Internship>
        + setCompanyName(String): void
        + setDepartment(String): void
        + setPosition(String): void
        + setAccountStatus(UserAccountStatus): void
    }

    class Internship <<Entity>> {
        - internshipId: String
        - title: String
        - description: String
        - internshipLevel: InternshipLevel
        - preferredMajor: StudentMajor
        - applicationOpenDate: LocalDate
        - applicationCloseDate: LocalDate
        - internshipStatus: InternshipStatus
        - companyName: String
        - companyRep: String
        - numOfSlots: int
        --
        + Internship(String, String, String, InternshipLevel, StudentMajor, LocalDate, LocalDate, InternshipStatus, String, String, int)
        + getInternshipId(): String
        + getTitle(): String
        + getDescription(): String
        + getInternshipLevel(): InternshipLevel
        + getPreferredMajor(): StudentMajor
        + getApplicationOpenDate(): LocalDate
        + getApplicationCloseDate(): LocalDate
        + getInternshipStatus(): InternshipStatus
        + getCompanyName(): String
        + getCompanyRep(): String
        + getNumOfSlots(): int
        + setters(): void
        + toString(): String
    }

    class InternshipApplication <<Entity>> {
        - applicationID: String
        - internship: Internship
        - student: Student
        - appliedDate: LocalDate
        - status: InternshipApplicationStatus
        --
        + InternshipApplication(String, Internship, Student, LocalDate, InternshipApplicationStatus)
        + getApplicationID(): String
        + getInternship(): Internship
        + getStudent(): Student
        + getAppliedDate(): LocalDate
        + getStatus(): InternshipApplicationStatus
        + setters(): void
        + toString(): String
    }

    class CompanyRepRegistration <<Entity>> {
        - companyRepId: String
        - name: String
        - companyName: String
        - department: String
        - position: String
        - email: String
        - status: UserAccountStatus
        --
        + CompanyRepRegistration(String, String, String, String, String, String, UserAccountStatus)
        + getters(): String
        + setStatus(UserAccountStatus): void
    }
}

' ============================================
' ENUM CLASSES
' ============================================
package "Enums" {

    enum UserType <<Enum>> {
        NONE
        STUDENT
        CCSTAFF
        COMREP
        --
        + fromString(String): UserType
    }

    enum UserAccountStatus <<Enum>> {
        PENDING
        APPROVED
        REJECTED
        --
        + fromString(String): UserAccountStatus
    }

    enum StudentMajor <<Enum>> {
        CS
        DSAI
        CE
        IEM
        COMP
        --
        + getFullName(): String
        + fromFullName(String): StudentMajor
    }

    enum InternshipLevel <<Enum>> {
        NONE
        BASIC
        INTERMEDIATE
        ADVANCED
        --
        + fromString(String): InternshipLevel
    }

    enum InternshipStatus <<Enum>> {
        PENDING
        APPROVED
        REJECTED
        FILLED
        --
        + fromString(String): InternshipStatus
    }

    enum InternshipApplicationStatus <<Enum>> {
        PENDING
        SUCCESSFUL
        UNSUCCESSFUL
        --
        + fromString(String): InternshipApplicationStatus
    }

    enum CSVType <<Enum>> {
        Student
        CCStaff
        CompanyRep
        Internship
        InternshipApplication
    }

    enum InternshipFilterOption <<Enum>> {
        PREFERRED_MAJOR
        INTERNSHIP_LEVEL
        INTERNSHIP_STATUS
        APPLICATION_OPEN_FROM
        APPLICATION_CLOSE_TO
    }
}

' ============================================
' CONTROLLER CLASSES
' ============================================
package "Controller Layer" {

    class StudentController <<Controller>> {
        - viewInternshipsAction: StudentAction
        - checkApplicationStatusAction: StudentAction
        --
        + StudentController()
        + showMenu(Student): void
    }

    class CareerCenterStaffController <<Controller>> {
        - reviewCompanyAction: StaffAction
        - reviewInternshipAction: StaffAction
        - viewInternshipsAction: StaffAction
        --
        + CareerCenterStaffController()
        + showMenu(CareerCenterStaff): void
    }

    class CompanyRepController <<Controller>> {
        - createInternshipAction: CompanyRepAction
        - listOwnInternshipsAction: CompanyRepAction
        - reviewApplicationsAction: CompanyRepAction
        - fileBoundary: FileBoundary
        --
        + CompanyRepController()
        + showMenu(CompanyRep): void
    }
}

' ============================================
' BOUNDARY CLASSES
' ============================================
package "Boundary Layer" {

    abstract class ConsoleBoundary <<Boundary>> {
        # {static} PAGE_SIZE: int = 5
        --
        + {static} clearScreen(): void
        + {static} safeValue(Object): String
        + {static} valueOrNA(Enum<?>): String
        + {static} parseDate(String): LocalDate
        + {static} promptUserInput(): String
        + {static} promptUserInput(boolean): String
        + {static} promptDate(String): LocalDate
        + {static} promptFormInput(String): String
        + {static} promptTryAgain(): boolean
        + {static} promptConfirmation(): boolean
        + {static} printSectionTitle(String): void
        + {static} printSectionTitle(String, boolean): void
        + {static} printText(String): void
        + {static} printChooseOption(): void
        + {static} printInvalidSelection(): void
        + {static} printInvalidInput(): void
        + {static} printErrorMessage(): void
        + {static} printWIP(): void
    }

    class InternshipBoundary <<Boundary>> {
        --
        + {static} printInternshipList(ArrayList<Internship>): void
        + {static} printInternshipList(ArrayList<Internship>, boolean): void
        + {static} buildSummaryLine(Internship, boolean): String
        + {static} printInternshipDetails(Internship): void
        + {static} printNoInternshipCreated(): void
        + {static} printMaxInternshipsReached(): void
        + {static} printCreateInternshipSummary(Internship): void
        + {static} displaySubMenu(boolean): int
        + {static} displayUpdateInternshipMenu(): int
        + {static} promptInternshipLevel(): InternshipLevel
        + {static} promptPreferredMajor(): StudentMajor
        + {static} promptNumOfSlots(String): int
    }

    interface FileBoundary <<Boundary>> {
        + writeInternship(ArrayList<Internship>): boolean
        + appendInternship(Internship): boolean
        + writeInternshipApplications(ArrayList<InternshipApplication>): boolean
        + appendInternshipApplicationToCsv(InternshipApplication): boolean
    }

    class CsvFileBoundary <<Boundary>> {
        --
        + writeInternship(ArrayList<Internship>): boolean
        + appendInternship(Internship): boolean
        + writeInternshipApplications(ArrayList<InternshipApplication>): boolean
        + appendInternshipApplicationToCsv(InternshipApplication): boolean
        - buildInternshipString(Internship): StringBuilder
        - buildInternshipApplicationString(InternshipApplication): StringBuilder
    }
}

' ============================================
' ACTION INTERFACES
' ============================================
package "Action Interfaces" {

    interface StudentAction <<Action>> {
        + run(Student): void
    }

    interface StaffAction <<Action>> {
        + run(CareerCenterStaff): void
    }

    interface CompanyRepAction <<Action>> {
        + run(CompanyRep): void
    }
}

' ============================================
' STUDENT ACTION CLASSES
' ============================================
package "Student Actions" {

    class ViewInternshipsAction <<Action>> {
        - {static} FILTER_OPTIONS: List<InternshipFilterOption>
        --
        + run(Student): void
        - getEligibleInternships(Student): List<Internship>
        - printNavigationPrompt(boolean, boolean): void
        - handleInternshipActions(Student, Internship): void
        - displayInternshipDetails(Internship): void
        - applyForInternship(Student, Internship): void
        - appendInternshipApplicationToCsv(InternshipApplication): boolean
        - buildInternshipString(InternshipApplication): StringBuilder
    }

    class CheckApplicationStatusAction <<Action>> {
        --
        + run(Student): void
        - displayApplicationDetails(InternshipApplication): void
        - acceptOffer(Student, InternshipApplication): void
    }
}

' ============================================
' COMPANY REP ACTION CLASSES
' ============================================
package "Company Rep Actions" {

    class CreateInternshipAction <<Action>> {
        - {static} MAX_SLOTS_NUM: int = 10
        - fileBoundary: FileBoundary
        --
        + CreateInternshipAction(FileBoundary)
        + run(CompanyRep): void
    }

    class ListOwnInternshipsAction <<Action>> {
        - {static} FILTER_OPTIONS: List<InternshipFilterOption>
        - fileBoundary: FileBoundary
        --
        + run(CompanyRep): void
        - handleInternshipActions(CompanyRep, Internship): void
        - updateInternship(Internship, CompanyRep, int): void
        - deleteInternship(Internship, CompanyRep): boolean
        - findCurrentInternshipInList(Internship, ArrayList<Internship>, CompanyRep): Internship
        - printNavigationPrompt(boolean, boolean): void
    }

    class ReviewApplicationsAction <<Action>> {
        --
        + run(CompanyRep): void
        - findApplicationsForInternships(ArrayList<Internship>): Map<Internship, List<InternshipApplication>>
        - hasAnyApplications(Map): boolean
        - displayInternshipsWithApplications(Map): void
        - reviewApplicationsForInternship(Internship, List<InternshipApplication>): void
        - displayApplicationList(List<InternshipApplication>): void
        - processApplication(InternshipApplication): void
        - approveApplication(InternshipApplication, Student): void
        - rejectApplication(InternshipApplication, Student): void
    }
}

' ============================================
' STAFF ACTION CLASSES
' ============================================
package "Staff Actions" {

    class StaffViewInternshipsAction <<Action>> {
        - {static} FILTER_OPTIONS: List<InternshipFilterOption>
        --
        + run(CareerCenterStaff): void
        - displayInternshipDetails(Internship): void
        - printNavigationPrompt(boolean, boolean): void
    }

    class ReviewInternshipSubmissionsAction <<Action>> {
        --
        + run(CareerCenterStaff): void
        - handleReview(Internship): void
        - printNavigationPrompt(boolean, boolean): void
        - waitForReturn(): void
        - writeInternshipsToCsv(): void
        - csvValue(Object): String
        - resolveCompanyName(Internship): String
    }

    class ReviewCompanyRegistrationsAction <<Action>> {
        --
        + run(CareerCenterStaff): void
        - printNavigationPrompt(boolean, boolean): void
        - handleReview(CompanyRep): void
        - writeCompanyRepsToCsv(): void
        - waitForReturn(): void
    }
}

' ============================================
' FILTER CLASSES
' ============================================
package "Filter Layer" {

    class InternshipFilter {
        --
        + {static} apply(List<Internship>, InternshipFilterCriteria): List<Internship>
    }

    class InternshipFilterCriteria {
        - preferredMajor: StudentMajor
        - internshipLevel: InternshipLevel
        - internshipStatus: InternshipStatus
        - applicationOpenFrom: LocalDate
        - applicationCloseTo: LocalDate
        --
        + getters/setters(): void
        + isEmpty(): boolean
    }

    class InternshipFilterPrompt {
        --
        + {static} prompt(List<InternshipFilterOption>): InternshipFilterCriteria
        - {static} labelFor(InternshipFilterOption): String
        - {static} promptMajor(): StudentMajor
        - {static} promptLevel(): InternshipLevel
        - {static} promptStatus(): InternshipStatus
        - {static} promptDate(String): LocalDate
    }
}

' ============================================
' REGISTRATION HANDLER
' ============================================
package "Registration Layer" {

    class CompanyRepRegistrationHandler {
        - resubmittingRep: CompanyRep
        --
        + startRegistration(): void
        - promptInput(String): String
        - promptUniqueCompanyEmail(): String
        - findRepByEmail(String): CompanyRep
        - submitRegistration(String, String, String, String, String, String): boolean
        - updateRejectedRegistration(String, String, String, String, String): void
        - writeCompanyRepsToCsv(): void
        - appendRegistrationToCsv(CompanyRep): boolean
    }
}

' ============================================
' MAIN APPLICATION CLASS
' ============================================
package "Application Layer" {

    class App {
        + {static} sc: Scanner
        + {static} studentList: ArrayList<Student>
        + {static} staffList: ArrayList<CareerCenterStaff>
        + {static} compRepList: ArrayList<CompanyRep>
        + {static} internshipList: ArrayList<Internship>
        + {static} internshipApplicationList: ArrayList<InternshipApplication>
        + {static} currentUser: User
        + {static} envFilePathStudent: String
        + {static} envFilePathStaff: String
        + {static} envFilePathRep: String
        + {static} envFilePathInternship: String
        + {static} envFilePathInternshipApplication: String
        + {static} DATE_DISPLAY_FORMATTER: DateTimeFormatter
        + {static} DATE_DB_FORMATTER: DateTimeFormatter
        --
        + {static} main(String[]): void
        + {static} verifyUserFromList(UserType, String, String): boolean
        + {static} ReadFromCSV(String, CSVType): void
        + {static} WriteToCSV(String, UserType): void
        + {static} updatePasswordAndPersist(UserType, String, String): boolean
        - {static} loadEnvironmentVariables(): void
        + {static} generateUniqueId(String, String[]): String
        + {static} idExists(String, String[]): boolean
    }
}

' ============================================
' INHERITANCE RELATIONSHIPS
' ============================================
User <|-- Student
User <|-- CareerCenterStaff
User <|-- CompanyRep
ConsoleBoundary <|-- InternshipBoundary
FileBoundary <|.. CsvFileBoundary

' ============================================
' INTERFACE IMPLEMENTATIONS
' ============================================
StudentAction <|.. ViewInternshipsAction
StudentAction <|.. CheckApplicationStatusAction
StaffAction <|.. StaffViewInternshipsAction
StaffAction <|.. ReviewInternshipSubmissionsAction
StaffAction <|.. ReviewCompanyRegistrationsAction
CompanyRepAction <|.. CreateInternshipAction
CompanyRepAction <|.. ListOwnInternshipsAction
CompanyRepAction <|.. ReviewApplicationsAction

' ============================================
' COMPOSITION RELATIONSHIPS (Strong ownership)
' ============================================
Student *-- "1..*" InternshipApplication : contains
CompanyRep *-- "0..5" Internship : creates
InternshipApplication *-- "1" Internship : references
InternshipApplication *-- "1" Student : applies

' ============================================
' AGGREGATION RELATIONSHIPS (Weak ownership)
' ============================================
StudentController o-- "1" ViewInternshipsAction : uses
StudentController o-- "1" CheckApplicationStatusAction : uses
CareerCenterStaffController o-- "1" StaffViewInternshipsAction : uses
CareerCenterStaffController o-- "1" ReviewInternshipSubmissionsAction : uses
CareerCenterStaffController o-- "1" ReviewCompanyRegistrationsAction : uses
CompanyRepController o-- "1" CreateInternshipAction : uses
CompanyRepController o-- "1" ListOwnInternshipsAction : uses
CompanyRepController o-- "1" ReviewApplicationsAction : uses
CompanyRepController o-- "1" FileBoundary : uses

' ============================================
' DEPENDENCY RELATIONSHIPS (Uses)
' ============================================
App ..> StudentController : creates
App ..> CareerCenterStaffController : creates
App ..> CompanyRepController : creates
App ..> CompanyRepRegistrationHandler : creates
App ..> Student : manages
App ..> CareerCenterStaff : manages
App ..> CompanyRep : manages
App ..> Internship : manages
App ..> InternshipApplication : manages

ViewInternshipsAction ..> InternshipBoundary : uses
ViewInternshipsAction ..> InternshipFilter : uses
ViewInternshipsAction ..> ConsoleBoundary : uses
CheckApplicationStatusAction ..> InternshipBoundary : uses
CheckApplicationStatusAction ..> ConsoleBoundary : uses

CreateInternshipAction ..> InternshipBoundary : uses
CreateInternshipAction ..> ConsoleBoundary : uses
ListOwnInternshipsAction ..> InternshipBoundary : uses
ListOwnInternshipsAction ..> ConsoleBoundary : uses
ReviewApplicationsAction ..> InternshipBoundary : uses
ReviewApplicationsAction ..> ConsoleBoundary : uses

StaffViewInternshipsAction ..> InternshipBoundary : uses
StaffViewInternshipsAction ..> InternshipFilter : uses
ReviewInternshipSubmissionsAction ..> InternshipBoundary : uses
ReviewCompanyRegistrationsAction ..> ConsoleBoundary : uses

InternshipFilter ..> InternshipFilterCriteria : uses
InternshipFilterPrompt ..> InternshipFilterCriteria : creates
ViewInternshipsAction ..> InternshipFilterPrompt : uses
ListOwnInternshipsAction ..> InternshipFilterPrompt : uses
StaffViewInternshipsAction ..> InternshipFilterPrompt : uses

CompanyRepRegistrationHandler ..> CompanyRep : creates

' ============================================
' ENUM ASSOCIATIONS
' ============================================
User --> UserType : has
CompanyRep --> UserAccountStatus : has
CompanyRepRegistration --> UserAccountStatus : has
Student --> StudentMajor : has
Internship --> InternshipLevel : has
Internship --> StudentMajor : has
Internship --> InternshipStatus : has
InternshipApplication --> InternshipApplicationStatus : has
App --> CSVType : uses
InternshipFilterCriteria --> InternshipFilterOption : uses
InternshipFilterCriteria --> StudentMajor : uses
InternshipFilterCriteria --> InternshipLevel : uses
InternshipFilterCriteria --> InternshipStatus : uses

@enduml
